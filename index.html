<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>INTUITY: Essay Expressions Master</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      margin: 0;
      background: #0a0a0a;
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
      color: #fff;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
      overflow-x: hidden;
    }

    .background {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at 30% 20%, rgba(201, 169, 97, 0.08) 0%, transparent 50%),
                  radial-gradient(circle at 70% 80%, rgba(74, 144, 226, 0.06) 0%, transparent 45%),
                  #0a0a0a;
      z-index: 0;
    }

    .container {
      max-width: 900px;
      width: 100%;
      position: relative;
      z-index: 1;
    }
    
    header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    header h1 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 3rem;
      font-weight: 700;
      color: #C9A961;
      margin-bottom: 0.25rem;
      letter-spacing: -0.04em;
      text-transform: uppercase;
    }
    
    .subtitle {
      font-size: 0.875rem;
      color: #C9A961;
      margin-bottom: 0.25rem;
      font-weight: 500;
      letter-spacing: 0.02em;
    }

    .author {
      font-size: 0.75rem;
      color: #8e8e93;
      margin-bottom: 0.25rem;
      font-weight: 400;
    }

    .topic {
      font-size: 0.8125rem;
      color: #C9A961;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .level-selector {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .level-btn {
      padding: 0.75rem 1.5rem;
      background: rgba(28, 28, 30, 0.85);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(201, 169, 97, 0.25);
      border-radius: 0.75rem;
      color: #8e8e93;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    .level-btn:hover {
      background: rgba(28, 28, 30, 0.95);
      color: #C9A961;
      border-color: rgba(201, 169, 97, 0.4);
      transform: translateY(-2px);
    }

    .level-btn.active {
      background: rgba(201, 169, 97, 0.15);
      color: #C9A961;
      border-color: rgba(201, 169, 97, 0.5);
      box-shadow: 0 0 20px rgba(201, 169, 97, 0.3);
    }

    .level-btn.practice-active {
      background: rgba(74, 144, 226, 0.15);
      color: #4a90e2;
      border-color: rgba(74, 144, 226, 0.5);
      box-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
    }
    
    .progress-section {
      background: rgba(28, 28, 30, 0.85);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      padding: 1rem 1.5rem;
      border-radius: 1rem;
      border: 1.5px solid rgba(201, 169, 97, 0.25);
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }
    
    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      font-size: 0.8rem;
      color: #8e8e93;
      font-weight: 600;
    }
    
    .progress-bar-container {
      height: 8px;
      background: rgba(201, 169, 97, 0.15);
      border-radius: 4px;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #C9A961 0%, #4a90e2 100%);
      border-radius: 4px;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 12px rgba(201, 169, 97, 0.5);
      width: 0%;
    }
    
    .card-container {
      perspective: 1500px;
      margin-bottom: 2rem;
    }
    
    .card {
      width: 100%;
      min-height: 500px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }
    
    .card.flipped {
      transform: rotateY(180deg);
    }
    
    .card-face {
      width: 100%;
      min-height: 500px;
      position: absolute;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      background: rgba(28, 28, 30, 0.98);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      border: 1.5px solid rgba(201, 169, 97, 0.25);
      border-radius: 1.5rem;
      padding: 3rem 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
    }
    
    .card-front {
      z-index: 2;
    }
    
    .card-back {
      transform: rotateY(180deg);
      background: rgba(28, 28, 30, 1);
      z-index: 3;
    }
    
    .card-label {
      font-size: 0.75rem;
      color: #636366;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 1rem;
      font-weight: 600;
    }
    
    .card-main-text {
      font-size: 1.5rem;
      line-height: 1.6;
      color: #e5e5e7;
      margin-bottom: 1.5rem;
      font-weight: 500;
      max-width: 700px;
    }

    .expression {
      color: #C9A961;
      font-weight: 700;
      background: rgba(201, 169, 97, 0.1);
      padding: 0.1rem 0.3rem;
      border-radius: 0.25rem;
    }

    .subject {
      color: #4a90e2;
      font-weight: 600;
    }

    .verb {
      color: #b94e48;
      font-weight: 600;
    }

    .context {
      color: #8e8e93;
      font-style: italic;
    }
    
    .card-back .card-main-text {
      font-size: 1.5rem;
      line-height: 1.6;
    }

    .breakdown-box {
      background: rgba(201, 169, 97, 0.08);
      border: 1px solid rgba(201, 169, 97, 0.3);
      border-radius: 1rem;
      padding: 1.5rem;
      margin: 1rem 0;
      text-align: left;
      width: 100%;
      max-width: 700px;
    }

    .breakdown-item {
      margin-bottom: 1rem;
      font-size: 0.95rem;
      line-height: 1.6;
    }

    .item-label {
      color: #C9A961;
      font-weight: 700;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.25rem;
      display: block;
    }

    .item-text {
      color: #e5e5e7;
      font-size: 1rem;
      line-height: 1.5;
    }

    .divider {
      text-align: center;
      font-size: 1.5rem;
      color: #636366;
      margin: 0.5rem 0;
    }
    
    .card-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.9;
    }
    
    .card-hint {
      font-size: 0.875rem;
      color: #8e8e93;
      margin-top: 2rem;
      padding: 0.75rem 1.5rem;
      background: rgba(201, 169, 97, 0.08);
      border-radius: 0.75rem;
      border: 1px solid rgba(201, 169, 97, 0.2);
    }
    
    .controls {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      align-items: center;
    }
    
    .arrows {
      display: flex;
      gap: 3rem;
      align-items: center;
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .arrow {
      width: 3.5rem;
      height: 3.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(28, 28, 30, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(201, 169, 97, 0.25);
      border-radius: 0.75rem;
      font-size: 1.5rem;
      color: #8e8e93;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }
    
    .arrow:hover {
      background: rgba(28, 28, 30, 0.95);
      color: #C9A961;
      border-color: rgba(201, 169, 97, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(201, 169, 97, 0.2);
    }
    
    .nav-dots {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 100%;
    }
    
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(201, 169, 97, 0.2);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(201, 169, 97, 0.3);
    }
    
    .dot:hover {
      transform: scale(1.4);
      background: rgba(201, 169, 97, 0.4);
    }
    
    .dot.active {
      background: #C9A961;
      box-shadow: 0 0 12px rgba(201, 169, 97, 0.6);
      transform: scale(1.3);
    }
    
    .dot.viewed {
      background: rgba(74, 144, 226, 0.5);
    }
    
    .reset-btn {
      padding: 1rem 2.5rem;
      background: #C9A961;
      color: #0a0a0a;
      border: none;
      border-radius: 0.75rem;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 16px rgba(201, 169, 97, 0.3);
    }
    
    .reset-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(201, 169, 97, 0.4);
      background: #d4b56f;
    }
    
    .category-badge {
      display: inline-block;
      padding: 0.375rem 1rem;
      background: rgba(201, 169, 97, 0.15);
      border: 1px solid rgba(201, 169, 97, 0.3);
      border-radius: 1.5rem;
      font-size: 0.7rem;
      color: #C9A961;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .legend {
      background: rgba(28, 28, 30, 0.85);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(201, 169, 97, 0.25);
      border-radius: 1rem;
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
      justify-content: center;
      font-size: 0.8rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 3px;
    }

    .color-expression { background: #C9A961; }
    .color-subject { background: #4a90e2; }
    .color-verb { background: #b94e48; }

    /* PRACTICE MODE STYLES */
    .practice-container {
      display: none;
    }

    .practice-container.active {
      display: block;
    }

    .practice-card {
      background: rgba(28, 28, 30, 0.98);
      backdrop-filter: blur(40px) saturate(150%);
      border: 1.5px solid rgba(74, 144, 226, 0.25);
      border-radius: 1.5rem;
      padding: 3rem 2rem;
      margin-bottom: 2rem;
      min-height: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .practice-question {
      font-size: 1.25rem;
      color: #e5e5e7;
      margin-bottom: 2rem;
      text-align: center;
      line-height: 1.6;
    }

    .practice-input {
      width: 100%;
      max-width: 600px;
      padding: 1rem 1.5rem;
      background: rgba(28, 28, 30, 0.9);
      border: 2px solid rgba(74, 144, 226, 0.3);
      border-radius: 0.75rem;
      color: #e5e5e7;
      font-size: 1.1rem;
      font-family: 'DM Sans', sans-serif;
      margin-bottom: 1.5rem;
      transition: all 0.3s;
    }

    .practice-input:focus {
      outline: none;
      border-color: #4a90e2;
      box-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
    }

    .practice-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      width: 100%;
      max-width: 600px;
    }

    .practice-option {
      padding: 1rem 1.5rem;
      background: rgba(28, 28, 30, 0.9);
      border: 2px solid rgba(74, 144, 226, 0.2);
      border-radius: 0.75rem;
      color: #e5e5e7;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      text-align: left;
    }

    .practice-option:hover {
      background: rgba(28, 28, 30, 1);
      border-color: rgba(74, 144, 226, 0.5);
      transform: translateX(5px);
    }

    .practice-option.correct {
      background: rgba(76, 175, 80, 0.2);
      border-color: rgba(76, 175, 80, 0.8);
      color: #4CAF50;
    }

    .practice-option.incorrect {
      background: rgba(244, 67, 54, 0.2);
      border-color: rgba(244, 67, 54, 0.8);
      color: #f44336;
    }

    .practice-option.disabled {
      pointer-events: none;
      opacity: 0.6;
    }

    .word-bank {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: center;
      margin-bottom: 2rem;
    }

    .word-chip {
      padding: 0.75rem 1.25rem;
      background: rgba(74, 144, 226, 0.15);
      border: 2px solid rgba(74, 144, 226, 0.3);
      border-radius: 0.75rem;
      color: #4a90e2;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      user-select: none;
    }

    .word-chip:hover {
      background: rgba(74, 144, 226, 0.25);
      transform: translateY(-2px);
    }

    .word-chip.used {
      opacity: 0.3;
      pointer-events: none;
    }

    .word-chip.selected {
      background: rgba(201, 169, 97, 0.25);
      border-color: rgba(201, 169, 97, 0.5);
      color: #C9A961;
    }

    .sentence-builder {
      min-height: 100px;
      padding: 1.5rem;
      background: rgba(28, 28, 30, 0.9);
      border: 2px dashed rgba(74, 144, 226, 0.3);
      border-radius: 0.75rem;
      margin-bottom: 2rem;
      font-size: 1.1rem;
      line-height: 1.8;
      color: #e5e5e7;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
    }

    .sentence-builder.has-words {
      border-style: solid;
    }

    .check-btn, .next-practice-btn, .show-answer-btn {
      padding: 1rem 3rem;
      background: #4a90e2;
      color: #fff;
      border: none;
      border-radius: 0.75rem;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      margin: 0.5rem;
    }

    .check-btn:hover, .next-practice-btn:hover, .show-answer-btn:hover {
      background: #5a9ee8;
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(74, 144, 226, 0.4);
    }

    .check-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .show-answer-btn {
      background: rgba(201, 169, 97, 0.8);
    }

    .show-answer-btn:hover {
      background: #C9A961;
    }

    .feedback {
      margin-top: 1.5rem;
      padding: 1.5rem;
      border-radius: 0.75rem;
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      display: none;
    }

    .feedback.correct {
      display: block;
      background: rgba(76, 175, 80, 0.2);
      border: 2px solid rgba(76, 175, 80, 0.5);
      color: #4CAF50;
    }

    .feedback.incorrect {
      display: block;
      background: rgba(244, 67, 54, 0.2);
      border: 2px solid rgba(244, 67, 54, 0.5);
      color: #f44336;
    }

    .practice-score {
      background: rgba(74, 144, 226, 0.15);
      border: 1px solid rgba(74, 144, 226, 0.3);
      border-radius: 1rem;
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      text-align: center;
      font-size: 1.1rem;
      color: #4a90e2;
      font-weight: 600;
    }

    .blank {
      display: inline-block;
      min-width: 120px;
      border-bottom: 2px solid #4a90e2;
      margin: 0 0.25rem;
      padding: 0 0.5rem;
      height: 1.5em;
    }
    
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }
      
      header h1 {
        font-size: 2rem;
      }
      
      .card-face, .practice-card {
        min-height: 450px;
        padding: 2rem 1.5rem;
      }
      
      .card-main-text, .practice-question {
        font-size: 1.25rem;
      }
      
      .breakdown-box {
        padding: 1rem;
      }
      
      .arrows {
        gap: 2rem;
      }
      
      .arrow {
        width: 3rem;
        height: 3rem;
      }

      .level-selector, .practice-type-selector {
        gap: 0.5rem;
      }

      .level-btn, .practice-type-btn {
        padding: 0.5rem 1rem;
        font-size: 0.75rem;
      }

      .legend {
        font-size: 0.7rem;
        gap: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="background"></div>
  
  <div class="container">
    <header>
      <h1>INTUITY</h1>
      <p class="subtitle">Intuitive & Immersive Learning</p>
      <p class="author">Majid Nashtai</p>
      <p class="topic">Advantages & Disadvantages Essays</p>
    </header>

    <div class="level-selector">
      <button class="level-btn active" onclick="changeLevel('advantages')" id="btnAdvantages">Introducing Advantages</button>
      <button class="level-btn" onclick="changeLevel('disadvantages')" id="btnDisadvantages">Introducing Disadvantages</button>
      <button class="level-btn" onclick="changeLevel('arguments')" id="btnArguments">Arguments & Criticism</button>
      <button class="level-btn" onclick="changeLevel('balancing')" id="btnBalancing">Balancing & Concluding</button>
      <button class="level-btn" onclick="togglePracticeMode()" id="btnPractice">🎯 Practice Mode</button>
    </div>

    <!-- LEARNING MODE -->
    <div id="learningMode">
      <div class="legend">
        <div class="legend-item">
          <div class="legend-color color-expression"></div>
          <span>Key Expression</span>
        </div>
        <div class="legend-item">
          <div class="legend-color color-subject"></div>
          <span>Subject/Topic</span>
        </div>
        <div class="legend-item">
          <div class="legend-color color-verb"></div>
          <span>Verb</span>
        </div>
      </div>
      
      <div class="progress-section">
        <div class="progress-header">
          <span>Progress</span>
          <span id="progressText">0/0 viewed</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>
      </div>
      
      <div class="card-container">
        <div class="card" id="card" onclick="flipCard()">
          <div class="card-face card-front">
            <div class="card-label">ESSAY EXPRESSION</div>
            <div class="category-badge" id="categoryFront"></div>
            <div class="card-icon" id="iconFront">✍️</div>
            <div class="card-main-text" id="sentenceText"></div>
            <div class="card-hint">💡 Click card to see structure breakdown</div>
          </div>
          <div class="card-face card-back">
            <div class="card-label">STRUCTURE & USAGE</div>
            <div class="category-badge" id="categoryBack"></div>
            <div class="card-icon" id="iconBack">🔍</div>
            <div id="breakdownContent"></div>
            <div class="card-hint">💡 Click to see example again</div>
          </div>
        </div>
      </div>
      
      <div class="controls">
        <div class="arrows">
          <div class="arrow" onclick="prevCard(); event.stopPropagation();">←</div>
          <div class="arrow" onclick="nextCard(); event.stopPropagation();">→</div>
        </div>
        <div class="nav-dots" id="navDots"></div>
        <button class="reset-btn" onclick="resetProgress()">↻ Reset Progress</button>
      </div>
    </div>

    <!-- PRACTICE MODE -->
    <div id="practiceMode" class="practice-container">
      <div class="practice-score" id="practiceScore">
        Question: 0/0 | Question: 0/0 | Score: 0/0 | Accuracy: 0%
      </div>

      <div class="practice-card" id="practiceCard">
        <!-- Dynamic practice content goes here -->
      </div>

      <div class="controls" style="margin-top: 1rem;">
        <button class="reset-btn" onclick="resetPractice()">🔄 New Practice Set</button>
      </div>
    </div>
  </div>

  <script>
    const data = {
      advantages: [
        {
          sentence: "<span class='expression'>One of the key advantages of</span> <span class='subject'>remote work</span> <span class='verb'>is</span> increased flexibility.",
          expression: "One of the key advantages of",
          context: "remote work is increased flexibility"
        },
        {
          sentence: "<span class='subject'>Online learning</span> <span class='expression'>enables</span> students to study at their own pace.",
          expression: "enables",
          context: "Online learning ___ students to study at their own pace"
        },
        {
          sentence: "<span class='subject'>Social media</span> <span class='expression'>encourages</span> people to stay connected with friends and family.",
          expression: "encourages",
          context: "Social media ___ people to stay connected"
        },
        {
          sentence: "<span class='subject'>Electric vehicles</span> <span class='expression'>make it easier to</span> reduce carbon emissions.",
          expression: "make it easier to",
          context: "Electric vehicles ___ reduce carbon emissions"
        },
        {
          sentence: "<span class='expression'>The main argument in favour of</span> <span class='subject'>renewable energy</span> is environmental sustainability.",
          expression: "The main argument in favour of",
          context: "___ renewable energy is environmental sustainability"
        },
        {
          sentence: "<span class='expression'>One positive aspect of</span> <span class='subject'>urbanization</span> <span class='verb'>is</span> improved access to services.",
          expression: "One positive aspect of",
          context: "___ urbanization is improved access to services"
        },
        {
          sentence: "<span class='subject'>Public transportation</span> <span class='expression'>helps</span> reduce traffic congestion in cities.",
          expression: "helps",
          context: "Public transportation ___ reduce traffic congestion"
        },
        {
          sentence: "<span class='expression'>A major benefit of</span> <span class='subject'>bilingualism</span> is enhanced cognitive flexibility.",
          expression: "A major benefit of",
          context: "___ bilingualism is enhanced cognitive flexibility"
        },
        {
          sentence: "<span class='subject'>Automation</span> <span class='expression'>permits</span> companies to increase productivity significantly.",
          expression: "permits",
          context: "Automation ___ companies to increase productivity"
        },
        {
          sentence: "<span class='subject'>Flexible working hours</span> <span class='expression'>let</span> employees balance work and personal life more effectively.",
          expression: "let",
          context: "Flexible working hours ___ employees balance work and personal life"
        }
      ],
      
      disadvantages: [
        {
          sentence: "<span class='expression'>One of the disadvantages of</span> <span class='subject'>social media</span> <span class='verb'>is</span> the spread of misinformation.",
          expression: "One of the disadvantages of",
          context: "___ social media is the spread of misinformation"
        },
        {
          sentence: "<span class='expression'>One of the arguments against</span> <span class='subject'>nuclear energy</span> is the issue of radioactive waste.",
          expression: "One of the arguments against",
          context: "___ nuclear energy is radioactive waste"
        },
        {
          sentence: "<span class='expression'>One of the problems is</span> <span class='subject'>the high cost of implementation</span>.",
          expression: "One of the problems is",
          context: "___ the high cost of implementation"
        },
        {
          sentence: "<span class='subject'>Excessive screen time</span> <span class='expression'>can lead to</span> various health problems.",
          expression: "can lead to",
          context: "Excessive screen time ___ various health problems"
        },
        {
          sentence: "<span class='subject'>Strict regulations</span> <span class='expression'>prevent</span> companies from innovating quickly.",
          expression: "prevent",
          context: "Strict regulations ___ companies from innovating quickly"
        },
        {
          sentence: "<span class='expression'>One criticism about</span> <span class='subject'>standardized testing</span> is that it doesn't measure creativity.",
          expression: "One criticism about",
          context: "___ standardized testing is it doesn't measure creativity"
        },
        {
          sentence: "<span class='subject'>Fast fashion</span> <span class='expression'>results in</span> massive environmental pollution.",
          expression: "results in",
          context: "Fast fashion ___ massive environmental pollution"
        },
        {
          sentence: "<span class='expression'>One negative aspect of</span> <span class='subject'>artificial intelligence</span> is potential job displacement.",
          expression: "One negative aspect of",
          context: "___ artificial intelligence is job displacement"
        },
        {
          sentence: "<span class='subject'>Bureaucracy</span> <span class='expression'>discourages</span> people from starting their own businesses.",
          expression: "discourages",
          context: "Bureaucracy ___ people from starting businesses"
        },
        {
          sentence: "<span class='expression'>A drawback of</span> <span class='subject'>working from home</span> is social isolation.",
          expression: "A drawback of",
          context: "___ working from home is social isolation"
        },
        {
          sentence: "<span class='subject'>Traffic congestion</span> <span class='expression'>hinders</span> economic development in major cities.",
          expression: "hinders",
          context: "Traffic congestion ___ economic development"
        }
      ],
      
      arguments: [
        {
          sentence: "<span class='expression'>The main argument in favour of</span> <span class='subject'>capital punishment</span> is deterrence.",
          expression: "The main argument in favour of",
          context: "___ capital punishment is deterrence"
        },
        {
          sentence: "<span class='expression'>Proponents argue that</span> <span class='subject'>genetic engineering</span> <span class='verb'>could solve</span> world hunger.",
          expression: "Proponents argue that",
          context: "___ genetic engineering could solve world hunger"
        },
        {
          sentence: "<span class='expression'>Critics claim that</span> <span class='subject'>standardized tests</span> <span class='verb'>fail to</span> measure true intelligence.",
          expression: "Critics claim that",
          context: "___ standardized tests fail to measure intelligence"
        },
        {
          sentence: "<span class='expression'>One criticism about</span> <span class='subject'>consumerism</span> is its environmental impact.",
          expression: "One criticism about",
          context: "___ consumerism is its environmental impact"
        },
        {
          sentence: "<span class='expression'>It is often argued that</span> <span class='subject'>technology</span> <span class='verb'>makes</span> people less social.",
          expression: "It is often argued that",
          context: "___ technology makes people less social"
        },
        {
          sentence: "<span class='expression'>Opponents contend that</span> <span class='subject'>free trade</span> <span class='verb'>harms</span> domestic industries.",
          expression: "Opponents contend that",
          context: "___ free trade harms domestic industries"
        },
        {
          sentence: "<span class='expression'>There is an ongoing debate about</span> whether <span class='subject'>AI</span> will benefit or harm humanity.",
          expression: "There is an ongoing debate about",
          context: "___ whether AI will benefit humanity"
        },
        {
          sentence: "<span class='expression'>A common objection to</span> <span class='subject'>wind farms</span> is their visual impact on landscapes.",
          expression: "A common objection to",
          context: "___ wind farms is their visual impact"
        },
        {
          sentence: "<span class='expression'>Advocates maintain that</span> <span class='subject'>veganism</span> <span class='verb'>is</span> the most ethical diet.",
          expression: "Advocates maintain that",
          context: "___ veganism is the most ethical diet"
        },
        {
          sentence: "<span class='expression'>Skeptics question whether</span> <span class='subject'>renewable energy</span> can truly replace fossil fuels.",
          expression: "Skeptics question whether",
          context: "___ renewable energy can replace fossil fuels"
        }
      ],
      
      balancing: [
        {
          sentence: "<span class='expression'>On the one hand,</span> <span class='subject'>social media</span> connects people. <span class='expression'>On the other hand,</span> it can be addictive.",
          expression: "On the one hand / On the other hand",
          context: "___ social media connects people. ___ it can be addictive"
        },
        {
          sentence: "<span class='expression'>While</span> <span class='subject'>technology</span> improves efficiency, <span class='expression'>it also</span> threatens jobs.",
          expression: "While / it also",
          context: "___ technology improves efficiency, ___ threatens jobs"
        },
        {
          sentence: "<span class='expression'>Despite the benefits,</span> <span class='subject'>globalization</span> <span class='verb'>has</span> significant drawbacks.",
          expression: "Despite the benefits",
          context: "___ globalization has significant drawbacks"
        },
        {
          sentence: "<span class='expression'>However,</span> not all the effects of <span class='subject'>urbanization</span> are positive.",
          expression: "However",
          context: "___ not all effects of urbanization are positive"
        },
        {
          sentence: "<span class='expression'>Although</span> <span class='subject'>online learning</span> offers flexibility, <span class='expression'>it lacks</span> face-to-face interaction.",
          expression: "Although / it lacks",
          context: "___ online learning offers flexibility, ___ face-to-face interaction"
        },
        {
          sentence: "<span class='expression'>In conclusion,</span> <span class='expression'>the advantages outweigh the disadvantages.</span>",
          expression: "In conclusion / outweigh",
          context: "___ the advantages ___ the disadvantages"
        },
        {
          sentence: "<span class='expression'>Weighing up both sides,</span> I believe the benefits are more significant.",
          expression: "Weighing up both sides",
          context: "___ I believe the benefits are more significant"
        },
        {
          sentence: "<span class='expression'>It is worth noting that</span> <span class='subject'>renewable energy</span> <span class='verb'>requires</span> significant initial investment.",
          expression: "It is worth noting that",
          context: "___ renewable energy requires investment"
        },
        {
          sentence: "<span class='expression'>Nevertheless,</span> the long-term benefits <span class='verb'>justify</span> the costs.",
          expression: "Nevertheless / justify",
          context: "___ the long-term benefits ___ the costs"
        },
        {
          sentence: "<span class='expression'>Taking everything into account,</span> the positives <span class='verb'>outweigh</span> the negatives.",
          expression: "Taking everything into account / outweigh",
          context: "___ the positives ___ the negatives"
        },
        {
          sentence: "<span class='expression'>That being said,</span> we must acknowledge the environmental concerns.",
          expression: "That being said",
          context: "___ we must acknowledge environmental concerns"
        },
        {
          sentence: "<span class='expression'>From my perspective,</span> the disadvantages <span class='verb'>are</span> more significant.",
          expression: "From my perspective",
          context: "___ the disadvantages are more significant"
        }
      ]
    };

    // LEARNING MODE VARIABLES
    let currentLevel = 'advantages';
    let currentIndex = 0;
    let viewedCards = new Set();
    let isFlipped = false;

        // LEARNING MODE FUNCTIONS
    function changeLevel(level) {
      if (practiceMode) return;
      
      currentLevel = level;
      currentIndex = 0;
      viewedCards.clear();
      isFlipped = false;
      
      document.querySelectorAll('.level-btn').forEach(btn => {
        if (btn.id !== 'btnPractice') btn.classList.remove('active');
      });
      document.getElementById('btn' + level.charAt(0).toUpperCase() + level.slice(1)).classList.add('active');
      
      updateCard();
      renderDots();
      updateProgress();
    }

    function updateCard() {
      const cardData = data[currentLevel][currentIndex];
      const card = document.getElementById('card');
      
      if (isFlipped) {
        card.classList.remove('flipped');
        isFlipped = false;
        const arrows = document.querySelector('.arrows');
        arrows.style.opacity = '1';
        arrows.style.pointerEvents = 'auto';
      }
      
      document.getElementById('sentenceText').innerHTML = cardData.sentence;
      
      let breakdownHTML = '<div class="card-main-text">' + cardData.sentence + '</div>';
      breakdownHTML += '<div class="breakdown-box">';
      breakdownHTML += '<div class="breakdown-item">';
      breakdownHTML += '<span class="item-label">Key Expression</span>';
      breakdownHTML += '<div class="item-text">' + cardData.expression + '</div>';
      breakdownHTML += '</div>';
      breakdownHTML += '</div>';
      
      document.getElementById('breakdownContent').innerHTML = breakdownHTML;
      
      const categoryNames = {
        advantages: 'Introducing Advantages',
        disadvantages: 'Introducing Disadvantages',
        arguments: 'Arguments & Criticism',
        balancing: 'Balancing & Concluding'
      };
      const categoryText = categoryNames[currentLevel];
      document.getElementById('categoryFront').textContent = categoryText;
      document.getElementById('categoryBack').textContent = categoryText;
      
      viewedCards.add(currentLevel + '-' + currentIndex);
      updateProgress();
      updateDots();
    }

    function flipCard() {
      const card = document.getElementById('card');
      card.classList.toggle('flipped');
      isFlipped = !isFlipped;
      
      const arrows = document.querySelector('.arrows');
      if (isFlipped) {
        arrows.style.opacity = '0';
        arrows.style.pointerEvents = 'none';
      } else {
        arrows.style.opacity = '1';
        arrows.style.pointerEvents = 'auto';
      }
    }

    function nextCard() {
      if (currentIndex < data[currentLevel].length - 1) {
        currentIndex++;
        updateCard();
      }
    }

    function prevCard() {
      if (currentIndex > 0) {
        currentIndex--;
        updateCard();
      }
    }

    function renderDots() {
      const dotsContainer = document.getElementById('navDots');
      dotsContainer.innerHTML = '';
      
      data[currentLevel].forEach((_, index) => {
        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.onclick = () => {
          currentIndex = index;
          updateCard();
        };
        dotsContainer.appendChild(dot);
      });
      
      updateDots();
    }

    function updateDots() {
      const dots = document.querySelectorAll('.dot');
      dots.forEach((dot, index) => {
        dot.classList.remove('active', 'viewed');
        if (index === currentIndex) {
          dot.classList.add('active');
        } else if (viewedCards.has(currentLevel + '-' + index)) {
          dot.classList.add('viewed');
        }
      });
    }

    function updateProgress() {
      const total = data[currentLevel].length;
      let viewed = 0;
      
      for (let i = 0; i < total; i++) {
        if (viewedCards.has(currentLevel + '-' + i)) {
          viewed++;
        }
      }
      
      const percentage = (viewed / total) * 100;
      document.getElementById('progressBar').style.width = percentage + '%';
      document.getElementById('progressText').textContent = viewed + '/' + total + ' viewed';
    }

    function resetProgress() {
      viewedCards.clear();
      currentIndex = 0;
      isFlipped = false;
      updateCard();
      updateProgress();
    }


    // PRACTICE MODE VARIABLES
    let practiceMode = false;
    let practiceData = [];
    let currentPracticeIndex = 0;
    let practiceScore = { correct: 0, total: 0, answered: 0 };
    let userAnswers = [];

    // PRACTICE MODE FUNCTIONS
    function togglePracticeMode() {
      practiceMode = !practiceMode;
      
      const learningMode = document.getElementById('learningMode');
      const practiceContainer = document.getElementById('practiceMode');
      const btnPractice = document.getElementById('btnPractice');
      
      if (practiceMode) {
        learningMode.style.display = 'none';
        practiceContainer.classList.add('active');
        btnPractice.classList.add('practice-active');
        
        document.querySelectorAll('.level-btn').forEach(btn => {
          if (btn.id !== 'btnPractice') btn.classList.remove('active');
        });
        
        initPractice();
      } else {
        learningMode.style.display = 'block';
        practiceContainer.classList.remove('active');
        btnPractice.classList.remove('practice-active');
        
        document.getElementById('btn' + currentLevel.charAt(0).toUpperCase() + currentLevel.slice(1)).classList.add('active');
      }
    }

    function initPractice() {
      practiceData = [];
      Object.keys(data).forEach(category => {
        data[category].forEach(item => {
          practiceData.push({
            ...item,
            category: category
          });
        });
      });
      
      practiceData = shuffleArray(practiceData).slice(0, 10);
      currentPracticeIndex = 0;
      practiceScore = { correct: 0, total: 0, answered: 0 };
      userAnswers = new Array(practiceData.length).fill(null);
      
      updatePracticeScore();
      showAllQuestions();
    }

    function showAllQuestions() {
      const card = document.getElementById('practiceCard');
      
      let html = `
        <div class="card-label">MULTIPLE CHOICE PRACTICE</div>
        <div style="color: #8e8e93; margin-bottom: 2rem; text-align: center; font-size: 1rem;">
          Select the correct expression for each sentence. You can answer in any order.<br>
          <strong>Complete all questions, then click Submit to check your answers.</strong>
        </div>
      `;
      
      practiceData.forEach((item, index) => {
        const correctAnswer = item.expression;
        const allExpressions = practiceData
          .filter(i => i.expression !== correctAnswer)
          .map(i => i.expression);
        
        const wrongAnswers = shuffleArray(allExpressions).slice(0, 3);
        const options = shuffleArray([correctAnswer, ...wrongAnswers]);
        
        const blankContext = item.context.replace('___', '<span style="color: #4a90e2; font-weight: 700;">[ ? ]</span>');
        
        html += `
          <div class="question-block" id="question-${index}" style="margin-bottom: 3rem; padding: 2rem; background: rgba(28, 28, 30, 0.6); border-radius: 1rem; border: 1px solid rgba(74, 144, 226, 0.2);">
            <div style="color: #C9A961; font-weight: 700; font-size: 0.9rem; margin-bottom: 1rem;">
              QUESTION ${index + 1}
            </div>
            <div class="practice-question" style="margin-bottom: 1.5rem;">
              ${blankContext}
            </div>
            <div class="practice-options" id="options-${index}">
        `;
        
        options.forEach((option, optIndex) => {
          html += `
            <div class="practice-option" id="option-${index}-${optIndex}" onclick="selectAnswer(${index}, '${option.replace(/'/g, "\\'")}', this)">
              ${option}
            </div>
          `;
        });
        
        html += `
            </div>
            <div class="feedback" id="feedback-${index}" style="margin-top: 1rem;"></div>
          </div>
        `;
      });
      
      html += `
        <div style="text-align: center; margin-top: 2rem;">
          <button class="check-btn" onclick="submitAllAnswers()" id="submitBtn" style="font-size: 1.1rem; padding: 1.25rem 3rem;">
            ✓ Submit and Check Answers
          </button>
        </div>
      `;
      
      card.innerHTML = html;
    }

    function selectAnswer(questionIndex, selectedAnswer, element) {
      if (practiceScore.answered > 0) return;
      
      const allOptions = document.querySelectorAll(`#options-${questionIndex} .practice-option`);
      allOptions.forEach(opt => {
        opt.style.background = 'rgba(28, 28, 30, 0.9)';
        opt.style.borderColor = 'rgba(74, 144, 226, 0.2)';
        opt.style.color = '#e5e5e7';
      });
      
      element.style.background = 'rgba(74, 144, 226, 0.25)';
      element.style.borderColor = 'rgba(74, 144, 226, 0.6)';
      element.style.color = '#4a90e2';
      
      userAnswers[questionIndex] = selectedAnswer;
      updatePracticeScore();
      
      const allAnswered = userAnswers.every(answer => answer !== null);
      const submitBtn = document.getElementById('submitBtn');
      if (allAnswered) {
        submitBtn.style.opacity = '1';
        submitBtn.style.transform = 'scale(1.05)';
      }
    }

    function submitAllAnswers() {
      const unanswered = userAnswers.filter(answer => answer === null).length;
      if (unanswered > 0) {
        alert(`Please answer all questions! ${unanswered} question(s) remaining.`);
        return;
      }
      
      practiceScore.answered = practiceData.length;
      practiceScore.total = practiceData.length;
      practiceScore.correct = 0;
      
      practiceData.forEach((item, index) => {
        const correctAnswer = item.expression;
        const userAnswer = userAnswers[index];
        const feedback = document.getElementById(`feedback-${index}`);
        const allOptions = document.querySelectorAll(`#options-${index} .practice-option`);
        
        allOptions.forEach(opt => {
          opt.style.pointerEvents = 'none';
          opt.classList.add('disabled');
          
          if (opt.textContent === correctAnswer) {
            opt.classList.add('correct');
            opt.style.background = 'rgba(76, 175, 80, 0.2)';
            opt.style.borderColor = 'rgba(76, 175, 80, 0.8)';
            opt.style.color = '#4CAF50';
          }
        });
        
        if (userAnswer === correctAnswer) {
          practiceScore.correct++;
          feedback.className = 'feedback correct';
          feedback.innerHTML = `✓ Correct!`;
        } else {
          feedback.className = 'feedback incorrect';
          feedback.innerHTML = `✗ Your answer: <strong>${userAnswer}</strong><br>Correct answer: <strong>${correctAnswer}</strong>`;
          
          allOptions.forEach(opt => {
            if (opt.textContent === userAnswer) {
              opt.classList.add('incorrect');
            }
          });
        }
      });
      
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.style.opacity = '0.5';
      submitBtn.textContent = 'Answers Submitted';
      
      updatePracticeScore();
      window.scrollTo({ top: 0, behavior: 'smooth' });
      
      setTimeout(() => {
        const accuracy = Math.round((practiceScore.correct / practiceScore.total) * 100);
        let message = '';
        let emoji = '';
        
        if (accuracy >= 90) {
          message = 'Outstanding! 🏆';
          emoji = '🏆';
        } else if (accuracy >= 70) {
          message = 'Great job! 🌟';
          emoji = '🌟';
        } else if (accuracy >= 50) {
          message = 'Good effort! 💪';
          emoji = '💪';
        } else {
          message = 'Keep practicing! 📚';
          emoji = '📚';
        }
        
        alert(`${emoji} ${message}\n\nYour Score: ${practiceScore.correct}/${practiceScore.total} (${accuracy}%)\n\nReview your answers below, then click "New Practice Set" to try again!`);
      }, 500);
    }

    function resetPractice() {
      initPractice();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function updatePracticeScore() {
      const accuracy = practiceScore.total > 0 ? Math.round((practiceScore.correct / practiceScore.total) * 100) : 0;
      const answered = userAnswers.filter(a => a !== null).length;
      
      if (practiceScore.answered === 0) {
        document.getElementById('practiceScore').textContent = 
          `Question: ${answered}/${practiceData.length} answered | Ready to submit when all complete`;
      } else {
        document.getElementById('practiceScore').textContent = 
          `Final Score: ${practiceScore.correct}/${practiceScore.total} correct | Accuracy: ${accuracy}%`;
      }
    }

    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }


    // KEYBOARD SHORTCUTS
    document.addEventListener('keydown', (e) => {
      if (practiceMode) return;
      
      if (e.key === 'ArrowLeft') prevCard();
      if (e.key === 'ArrowRight') nextCard();
      if (e.key === ' ') {
        e.preventDefault();
        flipCard();
      }
    });

    // INITIALIZE
    updateCard();
    renderDots();
    updateProgress();
  </script>
</body>
</html>
